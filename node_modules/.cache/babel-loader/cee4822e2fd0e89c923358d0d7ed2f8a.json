{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport PollTypes from \"./pollTypes\";\nimport { v4 as uuidv4 } from 'uuid';\nimport useSocket from \"../../hooks/useSocket\";\nconst initialState = {\n  \"connected_role\": \"Owner\",\n  //\"Owner\", \"User\" , \"Respondent\"\n  \"poll_main_question\": \"What is the value of π ?\",\n  \"poll_question_options\": []\n};\nconst resetState = {\n  \"connected_role\": \"Owner\",\n  //\"Owner\", \"User\" , \"Respondent\"\n  \"poll_main_question\": \"\",\n  \"poll_question_options\": []\n};\n\nconst PollReducer = function () {\n  _s();\n\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  // use socket\n  const {\n    socket\n  } = useSocket();\n\n  switch (action.type) {\n    case PollTypes.REFRESH_POLL_DATA:\n      {\n        // action.payload.data\n        const next_state = Object.assign({ ...state,\n          poll_question_options: action.payload.data.poll_question_options,\n          poll_main_question: action.payload.data.poll_main_question\n        });\n        return next_state;\n      }\n\n    case PollTypes.ADD_POLL:\n      {\n        const next_state = Object.assign({ ...state,\n          poll_question_options: [...state.poll_question_options, {\n            id: uuidv4(),\n            answer: action.payload,\n            votes: 0\n          }]\n        }); // emit new result;\n\n        socket.emit(\"refresh\", {\n          data: next_state\n        });\n        return next_state;\n      }\n\n    case PollTypes.RESET_POLL:\n      {\n        const next_state = resetState; // emit new result;\n\n        socket.emit(\"refresh\", {\n          data: next_state\n        });\n        return next_state;\n      }\n\n    case PollTypes.UPDATE_QUESTION:\n      {\n        const next_state = Object.assign({ ...state,\n          poll_main_question: action.payload\n        }); // emit new result;\n\n        socket.emit(\"refresh\", {\n          data: next_state\n        });\n        return next_state;\n      }\n\n    case PollTypes.REMOVE_AN_ANSWER:\n      {\n        const prev_state = Object.assign({ ...state\n        });\n        const new_poll_question_options = prev_state.poll_question_options.filter(poll => {\n          return poll.id != action.payload;\n        });\n        const next_state = Object.assign({ ...state,\n          poll_question_options: new_poll_question_options\n        }); // emit new result;\n\n        socket.emit(\"refresh\", {\n          data: next_state\n        });\n        return next_state;\n      }\n\n    case PollTypes.UPDATE_SINGLE_ANSWER:\n      {\n        console.log(\"store =>\", action.payload.id, action.payload.answer);\n        const prev_state = Object.assign({ ...state\n        });\n        const new_poll_question_options = prev_state.poll_question_options.map(poll => {\n          if (poll.id == action.payload.id) {\n            return Object.assign(poll, {\n              answer: action.payload.answer\n            });\n          } else {\n            return poll;\n          }\n        });\n        const next_state = Object.assign({ ...state,\n          poll_question_options: new_poll_question_options\n        }); // emit new result;\n\n        socket.emit(\"refresh\", {\n          data: next_state\n        });\n        return next_state;\n      }\n\n    case PollTypes.SWITCH_ROLE:\n      {\n        const next_state = Object.assign({ ...state,\n          connected_role: action.payload\n        });\n        return next_state;\n      }\n\n    case PollTypes.VOTING:\n      {\n        const prev_state = Object.assign({ ...state\n        });\n        const new_poll_question_options = prev_state.poll_question_options.map(poll => {\n          if (poll.id == action.payload) {\n            return Object.assign(poll, {\n              votes: poll.votes + 1\n            });\n          } else {\n            return poll;\n          }\n        }); // emit new result;\n\n        const next_state = Object.assign({ ...state,\n          poll_question_options: new_poll_question_options\n        }); // emit new result;\n\n        socket.emit(\"refresh\", {\n          data: next_state\n        });\n        return next_state;\n      }\n\n    default:\n      {\n        return state;\n      }\n  }\n};\n\n_s(PollReducer, \"RormeJw1bFNCKjCFmunl1fyVlPs=\", false, function () {\n  return [useSocket];\n});\n\n_c = PollReducer;\nexport default PollReducer;\n\nvar _c;\n\n$RefreshReg$(_c, \"PollReducer\");","map":{"version":3,"names":["PollTypes","v4","uuidv4","useSocket","initialState","resetState","PollReducer","state","action","socket","type","REFRESH_POLL_DATA","next_state","Object","assign","poll_question_options","payload","data","poll_main_question","ADD_POLL","id","answer","votes","emit","RESET_POLL","UPDATE_QUESTION","REMOVE_AN_ANSWER","prev_state","new_poll_question_options","filter","poll","UPDATE_SINGLE_ANSWER","console","log","map","SWITCH_ROLE","connected_role","VOTING"],"sources":["/Users/amine/Documents/Practices/Sir_vote_a_lot/PollApp/client/my-app/src/store/Polls/pollReducer.tsx"],"sourcesContent":["import { IPollQuestionOptions } from \"../../@types/poll.d\";\nimport PollTypes from \"./pollTypes\";\nimport { v4 as uuidv4 } from 'uuid';\nimport useSocket from \"../../hooks/useSocket\";\n\ntype TPayload = {\n    id:string ,\n    content:string\n}\n\ninterface IAction{\n    type:string,\n    payload: TPayload | string | number | any\n}\n\nconst initialState = {\n    \"connected_role\":\"Owner\", //\"Owner\", \"User\" , \"Respondent\"\n    \"poll_main_question\":\"What is the value of π ?\",\n    \"poll_question_options\":[]\n}\n\nconst resetState =  {\n    \"connected_role\":\"Owner\", //\"Owner\", \"User\" , \"Respondent\"\n    \"poll_main_question\":\"\",\n    \"poll_question_options\":[]\n}\n\nconst PollReducer = (state=initialState,action:IAction ) =>{\n\n    // use socket\n    const {socket} = useSocket();\n\n    switch(action.type){\n\n        case PollTypes.REFRESH_POLL_DATA :{\n\n            // action.payload.data\n\n            const next_state = Object.assign({...state, \n                poll_question_options:action.payload.data.poll_question_options,\n                poll_main_question:action.payload.data.poll_main_question\n            });\n\n\n            return next_state;\n        }\n\n        case PollTypes.ADD_POLL :{\n\n            const next_state = Object.assign({...state, poll_question_options:[...state.poll_question_options,{\n                id:uuidv4(),\n                answer:action.payload,\n                votes:0\n            }]});\n\n            // emit new result;\n            socket.emit(\"refresh\",{data:next_state});\n\n            return next_state;\n           \n        }\n\n        case PollTypes.RESET_POLL :{\n            \n            const next_state =  resetState;\n\n            // emit new result;\n            socket.emit(\"refresh\",{data:next_state});\n\n            return next_state;\n        }\n\n        case PollTypes.UPDATE_QUESTION :{\n\n            const next_state = Object.assign({...state, poll_main_question:action.payload});\n\n            // emit new result;\n            socket.emit(\"refresh\",{data:next_state});\n\n            return next_state;\n        }\n\n        case PollTypes.REMOVE_AN_ANSWER :{\n\n            const prev_state = Object.assign({...state});\n\n            const new_poll_question_options = prev_state.poll_question_options.filter((poll:IPollQuestionOptions)=>{\n                return poll.id != action.payload\n            });\n\n            const next_state = Object.assign({...state, poll_question_options:new_poll_question_options});\n\n            // emit new result;\n            socket.emit(\"refresh\",{data:next_state});\n\n            return next_state;\n\n        }\n\n        case PollTypes.UPDATE_SINGLE_ANSWER :{\n\n            console.log(\"store =>\",action.payload.id,action.payload.answer);\n\n            const prev_state = Object.assign({...state});\n\n            const new_poll_question_options = prev_state.poll_question_options.map((poll:IPollQuestionOptions)=>{\n                if(poll.id == action.payload.id){\n                   return Object.assign(poll,{answer:action.payload.answer});\n                 }else{\n                    return poll\n                 } \n            });\n\n            const next_state =  Object.assign({...state, poll_question_options:new_poll_question_options});\n\n            // emit new result;\n            socket.emit(\"refresh\",{data:next_state});\n\n            return next_state;\n\n        }\n        \n        case PollTypes.SWITCH_ROLE :{\n\n            const next_state =  Object.assign({...state, connected_role:action.payload});\n\n            return next_state;\n\n        }\n\n        case PollTypes.VOTING :{\n\n            const prev_state = Object.assign({...state});\n\n            const new_poll_question_options = prev_state.poll_question_options.map((poll:IPollQuestionOptions)=>{\n                if(poll.id == action.payload){\n                   return Object.assign(poll, {votes:(poll.votes + 1)});\n                 }else{\n                    return poll\n                 } \n            });\n\n            // emit new result;\n            const next_state = Object.assign({...state, poll_question_options:new_poll_question_options});\n\n            // emit new result;\n            socket.emit(\"refresh\",{data:next_state});\n\n            return next_state;\n\n        }\n    \n        default:{\n            return state;\n        }\n\n    }\n\n}\n\nexport default PollReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}