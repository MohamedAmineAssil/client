{"ast":null,"code":"import _toConsumableArray from\"/Users/amine/Documents/Practices/Sir_vote_a_lot/PollApp/client/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/Users/amine/Documents/Practices/Sir_vote_a_lot/PollApp/client/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import PollTypes from\"./pollTypes\";import{v4 as uuidv4}from'uuid';import useSocket from\"../../hooks/useSocket\";var initialState={\"connected_role\":\"Owner\",//\"Owner\", \"User\" , \"Respondent\"\n\"poll_main_question\":\"What is the value of π ?\",\"poll_question_options\":[{id:1,answer:\"3.14\",votes:10},{id:2,answer:\"3.15\",votes:3},{id:3,answer:\"3.16\",votes:2}]};var resetState={\"connected_role\":\"Owner\",//\"Owner\", \"User\" , \"Respondent\"\n\"poll_main_question\":\"\",\"poll_question_options\":[]};var PollReducer=function PollReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;// use socket\nvar _useSocket=useSocket(),socket=_useSocket.socket;switch(action.type){case PollTypes.REFRESH_POLL_DATA:{// action.payload.data\nvar next_state=Object.assign(_objectSpread(_objectSpread({},state),{},{poll_question_options:action.payload.data.poll_question_options,poll_main_question:action.payload.data.poll_main_question}));return next_state;}case PollTypes.ADD_POLL:{var _next_state=Object.assign(_objectSpread(_objectSpread({},state),{},{poll_question_options:[].concat(_toConsumableArray(state.poll_question_options),[{id:uuidv4(),answer:action.payload,votes:0}])}));// emit new result;\nsocket.emit(\"refresh\",{data:_next_state});return _next_state;}case PollTypes.RESET_POLL:{var _next_state2=resetState;// emit new result;\nsocket.emit(\"refresh\",{data:_next_state2});return _next_state2;}case PollTypes.UPDATE_QUESTION:{var _next_state3=Object.assign(_objectSpread(_objectSpread({},state),{},{poll_main_question:action.payload}));// emit new result;\nsocket.emit(\"refresh\",{data:_next_state3});return _next_state3;}case PollTypes.REMOVE_AN_ANSWER:{var prev_state=Object.assign(_objectSpread({},state));var new_poll_question_options=prev_state.poll_question_options.filter(function(poll){return poll.id!=action.payload;});var _next_state4=Object.assign(_objectSpread(_objectSpread({},state),{},{poll_question_options:new_poll_question_options}));// emit new result;\nsocket.emit(\"refresh\",{data:_next_state4});return _next_state4;}case PollTypes.UPDATE_SINGLE_ANSWER:{console.log(\"store =>\",action.payload.id,action.payload.answer);var _prev_state=Object.assign(_objectSpread({},state));var _new_poll_question_options=_prev_state.poll_question_options.map(function(poll){if(poll.id==action.payload.id){return Object.assign(poll,{answer:action.payload.answer});}else{return poll;}});var _next_state5=Object.assign(_objectSpread(_objectSpread({},state),{},{poll_question_options:_new_poll_question_options}));// emit new result;\nsocket.emit(\"refresh\",{data:_next_state5});return _next_state5;}case PollTypes.SWITCH_ROLE:{var _next_state6=Object.assign(_objectSpread(_objectSpread({},state),{},{connected_role:action.payload}));return _next_state6;}case PollTypes.VOTING:{var _prev_state2=Object.assign(_objectSpread({},state));var _new_poll_question_options2=_prev_state2.poll_question_options.map(function(poll){if(poll.id==action.payload){return Object.assign(poll,{votes:poll.votes+1});}else{return poll;}});// emit new result;\nvar _next_state7=Object.assign(_objectSpread(_objectSpread({},state),{},{poll_question_options:_new_poll_question_options2}));// emit new result;\nsocket.emit(\"refresh\",{data:_next_state7});return _next_state7;}default:{return state;}}};export default PollReducer;","map":{"version":3,"names":["PollTypes","v4","uuidv4","useSocket","initialState","id","answer","votes","resetState","PollReducer","state","action","socket","type","REFRESH_POLL_DATA","next_state","Object","assign","poll_question_options","payload","data","poll_main_question","ADD_POLL","emit","RESET_POLL","UPDATE_QUESTION","REMOVE_AN_ANSWER","prev_state","new_poll_question_options","filter","poll","UPDATE_SINGLE_ANSWER","console","log","map","SWITCH_ROLE","connected_role","VOTING"],"sources":["/Users/amine/Documents/Practices/Sir_vote_a_lot/PollApp/client/my-app/src/store/Polls/pollReducer.tsx"],"sourcesContent":["import { IPollQuestionOptions } from \"../../@types/poll.d\";\nimport PollTypes from \"./pollTypes\";\nimport { v4 as uuidv4 } from 'uuid';\nimport useSocket from \"../../hooks/useSocket\";\n\ntype TPayload = {\n    id:string ,\n    content:string\n}\n\ninterface IAction{\n    type:string,\n    payload: TPayload | string | number | any\n}\n\nconst initialState = {\n    \"connected_role\":\"Owner\", //\"Owner\", \"User\" , \"Respondent\"\n    \"poll_main_question\":\"What is the value of π ?\",\n    \"poll_question_options\":[\n        {\n            id:1,\n            answer:\"3.14\",\n            votes:10\n        },\n        {\n            id:2,\n            answer:\"3.15\",\n            votes:3\n        },\n        {\n            id:3,\n            answer:\"3.16\",\n            votes:2\n        },\n    ]\n}\n\nconst resetState =  {\n    \"connected_role\":\"Owner\", //\"Owner\", \"User\" , \"Respondent\"\n    \"poll_main_question\":\"\",\n    \"poll_question_options\":[]\n}\n\nconst PollReducer = (state=initialState,action:IAction ) =>{\n\n    // use socket\n    const {socket} = useSocket();\n\n    switch(action.type){\n\n        case PollTypes.REFRESH_POLL_DATA :{\n\n            // action.payload.data\n\n            const next_state = Object.assign({...state, \n                poll_question_options:action.payload.data.poll_question_options,\n                poll_main_question:action.payload.data.poll_main_question\n            });\n\n\n            return next_state;\n        }\n\n        case PollTypes.ADD_POLL :{\n\n            const next_state = Object.assign({...state, poll_question_options:[...state.poll_question_options,{\n                id:uuidv4(),\n                answer:action.payload,\n                votes:0\n            }]});\n\n            // emit new result;\n            socket.emit(\"refresh\",{data:next_state});\n\n            return next_state;\n           \n        }\n\n        case PollTypes.RESET_POLL :{\n            \n            const next_state =  resetState;\n\n            // emit new result;\n            socket.emit(\"refresh\",{data:next_state});\n\n            return next_state;\n        }\n\n        case PollTypes.UPDATE_QUESTION :{\n\n            const next_state = Object.assign({...state, poll_main_question:action.payload});\n\n            // emit new result;\n            socket.emit(\"refresh\",{data:next_state});\n\n            return next_state;\n        }\n\n        case PollTypes.REMOVE_AN_ANSWER :{\n\n            const prev_state = Object.assign({...state});\n\n            const new_poll_question_options = prev_state.poll_question_options.filter((poll:IPollQuestionOptions)=>{\n                return poll.id != action.payload\n            });\n\n            const next_state = Object.assign({...state, poll_question_options:new_poll_question_options});\n\n            // emit new result;\n            socket.emit(\"refresh\",{data:next_state});\n\n            return next_state;\n\n        }\n\n        case PollTypes.UPDATE_SINGLE_ANSWER :{\n\n            console.log(\"store =>\",action.payload.id,action.payload.answer);\n\n            const prev_state = Object.assign({...state});\n\n            const new_poll_question_options = prev_state.poll_question_options.map((poll:IPollQuestionOptions)=>{\n                if(poll.id == action.payload.id){\n                   return Object.assign(poll,{answer:action.payload.answer});\n                 }else{\n                    return poll\n                 } \n            });\n\n            const next_state =  Object.assign({...state, poll_question_options:new_poll_question_options});\n\n            // emit new result;\n            socket.emit(\"refresh\",{data:next_state});\n\n            return next_state;\n\n        }\n        \n        case PollTypes.SWITCH_ROLE :{\n\n            const next_state =  Object.assign({...state, connected_role:action.payload});\n\n            return next_state;\n\n        }\n\n        case PollTypes.VOTING :{\n\n            const prev_state = Object.assign({...state});\n\n            const new_poll_question_options = prev_state.poll_question_options.map((poll:IPollQuestionOptions)=>{\n                if(poll.id == action.payload){\n                   return Object.assign(poll, {votes:(poll.votes + 1)});\n                 }else{\n                    return poll\n                 } \n            });\n\n            // emit new result;\n            const next_state = Object.assign({...state, poll_question_options:new_poll_question_options});\n\n            // emit new result;\n            socket.emit(\"refresh\",{data:next_state});\n\n            return next_state;\n\n        }\n    \n        default:{\n            return state;\n        }\n\n    }\n\n}\n\nexport default PollReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}